{% extends "shop/base.html" %}
{% load static %}
{% block title %}
    {% if category %}{{ category.name }}{% else %}Products{% endif %}
{% endblock %}


{% block content %}

<div class="container">
    <div class="filter">
        <div class="filter_sort">
            <form action="" method="post">
                {% csrf_token %}
                {{form_sort.as_p}}
                <button>OK</button>
            </form>
        </div>

        <div class="filter_search">
            <p style="font-size: 25px">Поиск по параметрам:</p>
            <form action="" method="post">
                {% csrf_token %}
                {{form_search.as_p}}
                <button>OK</button>
            </form>
        </div>
    </div>

    <div id="main" class="product-list">
        <h2 style="text-align: center">{% if category %}{{ category.name }}{% else %}Товары{% endif %}</h2>

        {% for product in page_obj %}

            <div class="item">
                <div>
                    <a href="{{ product.get_absolute_url }}">
<!--                        <img class="item-img" src="{% if product.image %}{{ product.image.url }}{% else %}{% static 'img/no_image.png' %}{% endif %}">-->
                        <img class="item-img" src="{{product.product_image.first.img.url}}">
                    </a>
                </div>
                <div class="item-text">
                    <p><a href="{{ product.get_absolute_url }}">{{ product.name|upper }}</a></p>
                    <p>{{ product.price }} руб.</p>
                    <p>Бренд: {{product.brand}}</p>
                    <p>Осталось: {{ product.stock }} шт.</p>
                </div>
            </div>
        {% endfor %}
    </div>

<!--        <div class="pagination">-->
<!--            <span class="step-links">-->
<!--                {% if page_obj.has_previous %}-->
<!--                    <a href="?page=1">&laquo; </a>-->
<!--                    <a href="?page={{ page_obj.previous_page_number }}"> пред. </a>-->
<!--                {% endif %}-->

<!--                <span class="current">-->
<!--                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.-->
<!--                </span>-->

<!--                {% if page_obj.has_next %}-->
<!--                    <a href="?page={{ page_obj.next_page_number }}"> след. </a>-->
<!--                    <a href="?page={{ page_obj.paginator.num_pages }}">&raquo;</a>-->
<!--                {% endif %}-->
<!--            </span>-->
<!--        </div>-->



        <div class="pagination">
            <ul class="step-links">
                {% if page_obj.has_previous %}
                    <li><a href="?page=1"> << </a></li>
                    <li><a href="?page={{ page_obj.previous_page_number }}"> < </a></li>
                {% endif %}

                {% for i in paginator.page_range %}
                    <li><a href="?page={{i}}">{{i}}</a></li>
                {% endfor %}

                {% if page_obj.has_next %}
                    <li><a href="?page={{ page_obj.next_page_number }}"> > </a></li>
                    <li><a href="?page={{ page_obj.paginator.num_pages }}"> >> </a></li>
                {% endif %}

                <span class="current">
                    Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
                </span>
            </ul>
        </div>



</div>
{% endblock %}